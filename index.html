<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Loading...</title>
</head>
<body>
    <script>
        // --- 1. Get the Raw User Agent String ---
        const userAgent = navigator.userAgent;

        // --- 2. Function to Extract Key Device Info ---
        function getDeviceInfo(ua) {
            let os = 'Unknown OS';
            let model = 'Unknown Model/Device';
            let manufacturer = 'Unknown Manufacturer';
            let browser = 'Unknown Browser';
            let osVersion = 'N/A';

            // --- Primary OS Detection ---
            if (ua.includes('Android')) {
                os = 'Android';
                
                // Get Reported OS Version (may be intentionally incorrect by browser)
                const versionMatch = ua.match(/Android (\d+(?:\.\d+)*)/);
                if (versionMatch && versionMatch[1]) {
                    osVersion = versionMatch[1];
                }

                // *** FIX: Model Extraction ***
                // 1. Try to find the detailed model between the two main parentheses: (Linux; Android [Version]; [MODEL INFO] Build/...)
                let modelMatch = ua.match(/\(([^;]+); Android [^;]+; ([^)]+)\)/);
                
                if (modelMatch && modelMatch[2]) {
                    // This captures both old (detailed) and new (sanitized like 'K' or 'M') UAs.
                    let modelSegment = modelMatch[2].trim();
                    
                    // If the segment is just one letter or number (sanitized), fall back to checking if the original model was in the main parentheses.
                    if (modelSegment.length <= 2) {
                        modelMatch = ua.match(/Android [^;]+; ([^;)]+)(?:\sBuild\/)/);
                        if (modelMatch && modelMatch[1]) {
                           modelSegment = modelMatch[1].trim();
                        }
                    }

                    // Final cleanup and assignment
                    model = modelSegment.replace(/\s+Build\/.*/, '').trim();

                    // Attempt to infer manufacturer from model prefix
                    if (model.startsWith('SM-') || model.startsWith('SAMSUNG')) {
                        manufacturer = 'Samsung';
                    } else if (model.includes('Pixel') || model.startsWith('PXD')) {
                        manufacturer = 'Google';
                    } else if (model.includes('ONEPLUS') || model.includes('ONE')) {
                        manufacturer = 'OnePlus';
                    } else if (model.length > 2 && model !== 'K') { // If it's a real model string, use it.
                        manufacturer = 'Android Device'; 
                    }
                }
            } else if (ua.includes('iPhone') || ua.includes('iPad') || ua.includes('iPod')) {
                os = ua.includes('iPad') ? 'iPadOS' : 'iOS';
                model = ua.includes('iPad') ? 'iPad' : 'iPhone';
                manufacturer = 'Apple';
                const versionMatch = ua.match(/(iPhone|iPad|iPod);.*?OS\s(\d+_\d+)/);
                if (versionMatch && versionMatch[2]) {
                    osVersion = versionMatch[2].replace(/_/g, '.');
                }
            } else if (ua.includes('Windows')) {
                os = 'Windows';
                model = 'Desktop/Tablet';
            } else if (ua.includes('Macintosh')) {
                os = 'macOS';
                model = 'Desktop/Laptop';
            }

            // --- Browser Detection ---
            if (ua.includes('Chrome') && !ua.includes('Edg/')) {
                browser = ua.includes('CriOS') ? 'Chrome (iOS)' : 'Chrome';
            } else if (ua.includes('Edg/')) {
                browser = 'Edge';
            } else if (ua.includes('Firefox')) {
                browser = 'Firefox';
            } else if (ua.includes('Safari') && !ua.includes('Chrome')) {
                browser = 'Safari';
            } else if (ua.includes('OPR') || ua.includes('Opera')) {
                browser = 'Opera';
            }

            return { os, osVersion, model, manufacturer, browser };
        }

        const deviceData = getDeviceInfo(userAgent);

        // --- 3. Format the Message for Telegram ---
        const messageText = `
*--- NEW DEVICE CLICKED ---*

*Time:* ${new Date().toISOString()}
*OS/Version:* ${deviceData.os} (${deviceData.osVersion})
*Manufacturer:* ${deviceData.manufacturer}
*Model (Android Priority):* ${deviceData.model}
*Browser:* ${deviceData.browser}
*Screen:* ${screen.width}x${screen.height}

*Raw UA:* \`${userAgent}\`
        `.trim();


        // --- 4. Configuration ---
        const BOT_TOKEN = '8437574185:AAH3LG_IDft1pdrkfv-75rgWUCIWFYxECoM'; 
        const CHAT_ID = '7863510010';     
        const TELEGRAM_API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        const REDIRECT_URL = 'https://www.misha/dad/image23689/august2024.com'; 

        // --- 5. Send the Data and Redirect ---
        fetch(TELEGRAM_API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: messageText,
                parse_mode: 'Markdown' 
            })
        })
        .finally(() => {
            setTimeout(() => {
                window.location.replace(REDIRECT_URL);
            }, 1000); 
        });

    </script>
</body>
</html>
